generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum PeriodoSonoDia {
  manha
  tarde
}

enum SimNaoComAjuda {
  sim
  com_ajuda
  nao
}

enum BoaRuimAudicao {
  boa
  ruim
}

enum ata_finalidade_reuniao {
  orientacao_parental
  reuniao_equipe
  reuniao_outro_especialista
  reuniao_escola
  supervisao_at
  supervisao_terapeuta
  outros
}

enum ata_modalidade_reuniao {
  online
  presencial
}

enum ata_participante_tipo {
  familia
  profissional_externo
  profissional_clinica
}

enum ata_status {
  rascunho
  finalizada
}

model area_atuacao {
  id                    Int                     @id @default(autoincrement())
  nome                  String                  @db.VarChar(100)
  registro_profissional registro_profissional[]
}

model cargo {
  id                    Int                     @id @default(autoincrement())
  nome                  String                  @db.VarChar(100)
  registro_profissional registro_profissional[]
}

model cliente {
  id                  String              @id @default(uuid())
  nome                String?
  status              String?
  perfil_acesso       String?
  senha               String?
  token_redefinicao   String?
  validade_token      DateTime?
  criado_em           DateTime            @default(now())
  atualizado_em       DateTime            @updatedAt
  cpf                 String?
  dataEntrada         DateTime?
  dataNascimento      DateTime?
  dataSaida           DateTime?
  emailContato        String?             @unique
  senha_atualizada_em DateTime?
  arquivos            arquivos[]
  enderecos           cliente_endereco[]
  cuidadores          cuidador[]
  dadosEscola         dados_escola?
  dadosPagamento      dados_pagamento?
  ocp                 ocp[]
  sessao              sessao[]
  terapeuta           terapeuta_cliente[]
  relatorios          relatorio[]
  anamneses           anamnese[]
  ocp_prontuarios     ocp_prontuario[]
  atas_reuniao        ata_reuniao[]

  @@index([nome], map: "nome_idx")
}

model cuidador {
  id               Int       @id @default(autoincrement())
  relacao          String?
  descricaoRelacao String?
  nome             String?
  cpf              String    @db.Char(11)
  profissao        String?
  escolaridade     String?
  telefone         String?
  email            String?
  clienteId        String
  enderecoId       Int?
  dataNascimento   DateTime? @db.Date
  cliente          cliente   @relation(fields: [clienteId], references: [id])
  endereco         endereco? @relation(fields: [enderecoId], references: [id])

  @@unique([clienteId, cpf], name: "unique_cuidador")
  @@index([enderecoId], map: "cuidador_enderecoId_fkey")
}

model cliente_endereco {
  id              Int      @id @default(autoincrement())
  clienteId       String
  enderecoId      Int
  outroResidencia String?
  residenciaDe    String?
  cliente         cliente  @relation(fields: [clienteId], references: [id])
  endereco        endereco @relation(fields: [enderecoId], references: [id])

  @@index([clienteId], map: "cliente_endereco_clienteId_fkey")
  @@index([enderecoId], map: "cliente_endereco_enderecoId_fkey")
}

model dados_pagamento {
  id                Int      @id @default(autoincrement())
  clienteId         String   @unique
  nomeTitular       String?
  numeroCarteirinha String?
  telefone1         String?
  telefone2         String?
  telefone3         String?
  email1            String?
  email2            String?
  email3            String?
  sistemaPagamento  String
  prazoReembolso    String?
  numeroProcesso    String?
  nomeAdvogado      String?
  telefoneAdvogado1 String?
  telefoneAdvogado2 String?
  telefoneAdvogado3 String?
  emailAdvogado1    String?
  emailAdvogado2    String?
  emailAdvogado3    String?
  houveNegociacao   String?
  valorAcordado     String?
  criado_em         DateTime @default(now())
  atualizado_em     DateTime @updatedAt
  cliente           cliente  @relation(fields: [clienteId], references: [id])
}

model dados_escola {
  id         Int              @id @default(autoincrement())
  clienteId  String           @unique
  tipoEscola String
  nome       String?
  telefone   String?
  email      String?
  enderecoId Int?
  cliente    cliente          @relation(fields: [clienteId], references: [id])
  endereco   endereco?        @relation(fields: [enderecoId], references: [id])
  contatos   escola_contato[]

  @@index([enderecoId], map: "dados_escola_enderecoId_fkey")
}

model escola_contato {
  id            Int          @id @default(autoincrement())
  dadosEscolaId Int
  nome          String?
  telefone      String?
  email         String?
  funcao        String?
  dadosEscola   dados_escola @relation(fields: [dadosEscolaId], references: [id])

  @@index([dadosEscolaId], map: "escola_contato_dadosEscolaId_fkey")
}

model arquivos {
  id                  Int        @id @default(autoincrement())
  clienteId           String?
  terapeutaId         String?
  tipo                String?
  descricao_documento String?
  arquivo_id          String?
  mime_type           String?
  tamanho             Int?
  data_upload         DateTime   @default(now())
  cliente             cliente?   @relation(fields: [clienteId], references: [id])
  terapeuta           terapeuta? @relation(fields: [terapeutaId], references: [id])

  @@index([tipo])
  @@index([clienteId], map: "arquivos_clienteId_fkey")
  @@index([terapeutaId], map: "arquivos_terapeutaId_fkey")
}

model relatorio {
  id                     String   @id @default(uuid())
  titulo                 String
  tipo                   String
  status                 String   @default("final")
  periodo_inicio         DateTime
  periodo_fim            DateTime
  observacoes_clinicas   String?  @db.LongText
  filtros                Json?
  dados_gerados          Json?
  pdf_arquivo_id         String?
  pdf_nome               String?
  pdf_mime               String?
  pdf_tamanho            Int?
  pasta_relatorios_drive String?
  clienteId              String
  terapeutaId            String
  criado_em              DateTime @default(now())
  atualizado_em          DateTime @updatedAt
  area                   String   @default("fonoaudiologia")

  cliente   cliente   @relation(fields: [clienteId], references: [id])
  terapeuta terapeuta @relation(fields: [terapeutaId], references: [id])

  @@index([clienteId], map: "relatorio_clienteId_idx")
  @@index([terapeutaId], map: "relatorio_terapeutaId_idx")
  @@index([periodo_inicio, periodo_fim], map: "relatorio_periodo_idx")
  @@index([clienteId, area], map: "relatorio_clienteId_area_idx")
  @@index([area], map: "relatorio_area_idx")
}

model endereco {
  id                 Int                @id @default(autoincrement())
  cep                String?            @db.Char(8)
  rua                String?            @db.VarChar(255)
  numero             String?            @db.VarChar(10)
  bairro             String?            @db.VarChar(100)
  cidade             String?            @db.VarChar(100)
  uf                 String?            @db.Char(2)
  complemento        String             @default("")
  criado_em          DateTime           @default(now())
  atualizado_em      DateTime           @updatedAt
  cliente_endereco   cliente_endereco[]
  cuidador           cuidador[]
  escola             dados_escola[]
  pessoa_juridica    pessoa_juridica[]
  terapeuta_endereco terapeuta[]

  @@unique([cep, rua, numero, bairro, cidade, uf, complemento], name: "unique_endereco")
  @@index([cep])
  @@index([cidade, uf])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model terapeuta {
  id                    String                  @id @default(uuid())
  nome                  String
  email                 String                  @unique
  email_indigo          String                  @unique
  celular               String
  telefone              String?
  cpf                   String                  @unique
  data_nascimento       DateTime
  possui_veiculo        Boolean                 @default(false)
  placa_veiculo         String?
  modelo_veiculo        String?
  banco                 String?
  agencia               String?
  conta                 String?
  chave_pix             String?
  valor_hora            Decimal?                @db.Decimal(10, 2)
  professor_uni         Boolean                 @default(false)
  endereco_id           Int?
  data_entrada          DateTime
  data_saida            DateTime?
  perfil_acesso         String
  atividade             Boolean                 @default(true)
  senha                 String?                 @db.VarChar(255)
  token_redefinicao     String?
  validade_token        DateTime?
  criado_em             DateTime                @default(now())
  atualizado_em         DateTime                @updatedAt
  pix_tipo              String?
  senha_atualizada_em   DateTime?
  arquivos              arquivos[]
  formacao              formacao?
  ocp                   ocp[]                   @relation("TerapeutaOcp")
  pessoa_juridica       pessoa_juridica?
  registro_profissional registro_profissional[]
  sessao                sessao[]
  endereco              endereco?               @relation(fields: [endereco_id], references: [id])
  cliente               terapeuta_cliente[]
  supervisor            vinculo_supervisao[]    @relation("ClinicoVinculo")
  supervisionados       vinculo_supervisao[]    @relation("SupervisorVinculo")
  disciplina            disciplina[]            @relation("disciplinaToterapeuta")
  relatorios            relatorio[]
  anamneses             anamnese[]
  ocp_prontuarios       ocp_prontuario[]
  atas_reuniao          ata_reuniao[]
  atas_participacoes    ata_participante[]

  @@index([atividade])
  @@index([nome])
  @@index([endereco_id], map: "terapeuta_endereco_id_fkey")
}

model anamnese {
  id Int @id @default(autoincrement())

  // relações
  cliente_id String
  cliente    cliente @relation(fields: [cliente_id], references: [id])

  terapeuta_id String
  terapeuta    terapeuta @relation(fields: [terapeuta_id], references: [id])

  // cabeçalho
  data_entrevista      DateTime
  informante           String
  parentesco           String
  parentesco_descricao String?
  quem_indicou         String?

  // relações 1-1 com blocos maiores
  queixa_diagnostico       anamnese_queixa_diagnostico?       @relation("anamnese_queixa_diagnostico")
  contexto_familiar_rotina anamnese_contexto_familiar_rotina? @relation("anamnese_contexto_familiar_rotina")
  desenvolvimento_inicial  anamnese_desenvolvimento_inicial?  @relation("anamnese_desenvolvimento_inicial")
  atividades_vida_diaria   anamnese_atividades_vida_diaria?   @relation("anamnese_atividades_vida_diaria")
  social_academico         anamnese_social_academico?         @relation("anamnese_social_academico")
  comportamento            anamnese_comportamento?            @relation("anamnese_comportamento")
  finalizacao              anamnese_finalizacao?              @relation("anamnese_finalizacao")

  criado_em     DateTime @default(now())
  atualizado_em DateTime @updatedAt
}

model anamnese_queixa_diagnostico {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_queixa_diagnostico", fields: [anamnese_id], references: [id], onDelete: Cascade)

  queixa_principal            String
  diagnostico_previo          String?
  suspeita_condicao_associada String?

  especialidades_consultada anamnese_especialidade_consultada[]
  medicamentos_em_uso       anamnese_medicamento_em_uso[]
  exames_previos            anamnese_exame_previo[]
  terapias_previas          anamnese_terapia_previa[]

  @@index([anamnese_id])
}

model anamnese_especialidade_consultada {
  id Int @id @default(autoincrement())

  anamnese_id Int
  anamnese    anamnese_queixa_diagnostico @relation(fields: [anamnese_id], references: [anamnese_id], onDelete: Cascade)

  especialidade String?
  nome          String?
  data          String?
  observacao    String?
  ativo         Boolean? @default(true)

  @@index([anamnese_id])
}

model anamnese_medicamento_em_uso {
  id          Int                         @id @default(autoincrement())
  anamnese_id Int
  anamnese    anamnese_queixa_diagnostico @relation(fields: [anamnese_id], references: [anamnese_id], onDelete: Cascade)

  nome        String?
  dosagem     String?
  data_inicio String?
  motivo      String?

  @@index([anamnese_id])
}

model anamnese_exame_previo {
  id          Int                         @id @default(autoincrement())
  anamnese_id Int
  anamnese    anamnese_queixa_diagnostico @relation(fields: [anamnese_id], references: [anamnese_id], onDelete: Cascade)

  nome      String?
  data      String?
  resultado String?

  arquivos anamnese_arquivo_exame_previo[]

  @@index([anamnese_id])
}

model anamnese_arquivo_exame_previo {
  id       Int                   @id @default(autoincrement())
  exame_id Int
  exame    anamnese_exame_previo @relation(fields: [exame_id], references: [id], onDelete: Cascade)

  nome    String?
  caminho String?
  tipo    String?
  tamanho Int?

  @@index([exame_id])
}

model anamnese_terapia_previa {
  id          Int                         @id @default(autoincrement())
  anamnese_id Int
  anamnese    anamnese_queixa_diagnostico @relation(fields: [anamnese_id], references: [anamnese_id], onDelete: Cascade)

  profissional            String?
  especialidade_abordagem String?
  tempo_intervencao       String?
  observacao              String?
  ativo                   Boolean? @default(true)

  @@index([anamnese_id])
  @@index([profissional])
  @@index([especialidade_abordagem])
}

model anamnese_contexto_familiar_rotina {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_contexto_familiar_rotina", fields: [anamnese_id], references: [id], onDelete: Cascade)

  historicos_familiares anamnese_historico_familiar[]
  atividades_rotina     anamnese_atividade_rotina[]

  @@index([anamnese_id])
}

model anamnese_historico_familiar {
  id          Int                               @id @default(autoincrement())
  contexto_id Int
  contexto    anamnese_contexto_familiar_rotina @relation(fields: [contexto_id], references: [anamnese_id], onDelete: Cascade)

  condicao_diagnostico String?
  parentesco           String?
  observacao           String?

  @@index([contexto_id])
}

model anamnese_atividade_rotina {
  id          Int                               @id @default(autoincrement())
  contexto_id Int
  contexto    anamnese_contexto_familiar_rotina @relation(fields: [contexto_id], references: [anamnese_id], onDelete: Cascade)

  atividade   String?
  horario     String?
  responsavel String?
  frequencia  String?
  observacao  String?

  @@index([contexto_id])
}

model anamnese_desenvolvimento_inicial {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_desenvolvimento_inicial", fields: [anamnese_id], references: [id], onDelete: Cascade)

  // gestação / parto
  tipo_parto      String // "natural" | "cesarea"
  semanas         Int
  apgar_1_min     Int
  apgar_5_min     Int
  intercorrencias String?

  // neuropsicomotor - marcos (meses + flags)
  sustentou_cabeca_meses              String?
  sustentou_cabeca_nao_realiza        Boolean?
  sustentou_cabeca_nao_soube_informar Boolean?

  rolou_meses              String?
  rolou_nao_realiza        Boolean?
  rolou_nao_soube_informar Boolean?

  sentou_meses              String?
  sentou_nao_realiza        Boolean?
  sentou_nao_soube_informar Boolean?

  engatinhou_meses              String?
  engatinhou_nao_realiza        Boolean?
  engatinhou_nao_soube_informar Boolean?

  andou_com_apoio_meses              String?
  andou_com_apoio_nao_realiza        Boolean?
  andou_com_apoio_nao_soube_informar Boolean?

  andou_sem_apoio_meses              String?
  andou_sem_apoio_nao_realiza        Boolean?
  andou_sem_apoio_nao_soube_informar Boolean?

  correu_meses              String?
  correu_nao_realiza        Boolean?
  correu_nao_soube_informar Boolean?

  andou_de_motoca_meses              String?
  andou_de_motoca_nao_realiza        Boolean?
  andou_de_motoca_nao_soube_informar Boolean?

  andou_de_bicicleta_meses              String?
  andou_de_bicicleta_nao_realiza        Boolean?
  andou_de_bicicleta_nao_soube_informar Boolean?

  subiu_escadas_sozinho_meses              String?
  subiu_escadas_sozinho_nao_realiza        Boolean?
  subiu_escadas_sozinho_nao_soube_informar Boolean?

  motricidade_fina String?

  // fala / linguagem - marcos (meses + flags)
  balbuciou_meses              String?
  balbuciou_nao                Boolean?
  balbuciou_nao_soube_informar Boolean?

  primeiras_palavras_meses              String?
  primeiras_palavras_nao                Boolean?
  primeiras_palavras_nao_soube_informar Boolean?

  primeiras_frases_meses              String?
  primeiras_frases_nao                Boolean?
  primeiras_frases_nao_soube_informar Boolean?

  apontou_para_fazer_pedidos_meses              String?
  apontou_para_fazer_pedidos_nao                Boolean?
  apontou_para_fazer_pedidos_nao_soube_informar Boolean?

  // demais campos de fala/linguagem
  faz_uso_de_gestos       Boolean?
  faz_uso_de_gestos_quais String?

  audicao BoaRuimAudicao? // "boa" | "ruim"

  teve_otite_de_repeticao Boolean?
  otite_vezes             Int?
  otite_periodo_meses     Int?
  otite_frequencia        String?

  faz_ou_fez_uso_tubo_ventilacao Boolean?
  tubo_ventilacao_observacao     String?

  faz_ou_fez_uso_objeto_oral Boolean?
  objeto_oral_especificar    String?

  usa_mamadeira          Boolean?
  mamadeira_ha           String?
  mamadeira_vezes_ao_dia Int?

  comunicacao_atual String?

  @@index([anamnese_id])
}

model anamnese_atividades_vida_diaria {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_atividades_vida_diaria", fields: [anamnese_id], references: [id], onDelete: Cascade)

  // desfralde
  desfralde_diurno_urina_anos           String?
  desfralde_diurno_urina_meses          String?
  desfralde_diurno_urina_utiliza_fralda Boolean?

  desfralde_noturno_urina_anos           String?
  desfralde_noturno_urina_meses          String?
  desfralde_noturno_urina_utiliza_fralda Boolean?

  desfralde_fezes_anos           String?
  desfralde_fezes_meses          String?
  desfralde_fezes_utiliza_fralda Boolean?

  se_limpa_sozinho_urinar               Boolean?
  se_limpa_sozinho_defecar              Boolean?
  lava_as_maos_apos_uso_banheiro        Boolean?
  apresenta_alteracao_habito_intestinal Boolean?

  desfralde_observacoes String?

  // SONO
  dormem_media_horas_noite String?
  dormem_media_horas_dia   String?

  periodo_sono_dia PeriodoSonoDia?

  tem_dificuldade_iniciar_sono Boolean?
  acorda_de_madrugada          Boolean?
  dorme_na_propria_cama        Boolean?
  dorme_no_proprio_quarto      Boolean?
  apresenta_sono_agitado       Boolean?
  e_sonambulo                  Boolean?

  sono_observacoes String?

  // HÁBITOS DE HIGIENE
  toma_banho_lava_corpo_todo SimNaoComAjuda?
  seca_corpo_todo            SimNaoComAjuda?
  retira_todas_pecas_roupa   SimNaoComAjuda?
  coloca_todas_pecas_roupa   SimNaoComAjuda?
  poe_calcados_sem_cadarco   SimNaoComAjuda?
  poe_calcados_com_cadarco   SimNaoComAjuda?
  escova_os_dentes           SimNaoComAjuda?
  penteia_o_cabelo           SimNaoComAjuda?

  habitos_higiene_observacoes String?

  // ALIMENTAÇÃO
  apresenta_queixa_alimentacao     Boolean?
  se_alimenta_sozinho              Boolean?
  e_seletivo_quanto_alimentos      Boolean?
  passa_dia_inteiro_sem_comer      Boolean?
  apresenta_rituais_para_alimentar Boolean?

  esta_abaixo_ou_acima_peso           Boolean?
  esta_abaixo_ou_acima_peso_descricao String?

  tem_historico_anemia           Boolean?
  tem_historico_anemia_descricao String?

  rotina_alimentar_problema_familia      Boolean?
  rotina_alimentar_problema_familia_desc String?

  alimentacao_observacoes String?

  @@index([anamnese_id])
}

model anamnese_social_academico {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_social_academico", fields: [anamnese_id], references: [id], onDelete: Cascade)

  // DESENVOLVIMENTO SOCIAL
  possui_amigos_mesma_idade_escola      Boolean?
  possui_amigos_mesma_idade_fora_escola Boolean?
  faz_uso_funcional_brinquedos          Boolean?
  brinca_proximo_aos_colegas            Boolean?
  brinca_conjunta_com_colegas           Boolean?
  procura_colegas_espontaneamente       Boolean?
  se_verbal_inicia_conversa             Boolean?
  se_verbal_responde_perguntas_simples  Boolean?
  faz_pedidos_quando_necessario         Boolean?
  estabelece_contato_visual_adultos     Boolean?
  estabelece_contato_visual_criancas    Boolean?

  desenvolvimento_social_observacoes String?

  // DESENVOLVIMENTO ACADÊMICO
  ano                   Int?
  periodo               String?
  direcao               String?
  coordenacao           String?
  professora_principal  String?
  professora_assistente String?

  frequenta_escola_regular               Boolean?
  frequenta_escola_especial              Boolean?
  acompanha_turma_demandas_pedagogicas   Boolean?
  segue_regras_rotina_sala_aula          Boolean?
  necessita_apoio_at                     Boolean?
  necessita_adaptacao_materiais          Boolean?
  necessita_adaptacao_curricular         Boolean?
  houve_reprovacao_retencao              Boolean?
  escola_possui_equipe_inclusao          Boolean?
  ha_indicativo_deficiencia_intelectual  Boolean?
  escola_apresenta_queixa_comportamental Boolean?

  adaptacao_escolar                     String?
  dificuldades_escolares                String?
  relacionamento_com_colegas            String?
  desenvolvimento_academico_observacoes String?

  @@index([anamnese_id])
}

model anamnese_comportamento {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_comportamento", fields: [anamnese_id], references: [id], onDelete: Cascade)

  // ESTEREOTIPIAS / RITUAIS
  balanca_maos_lado_corpo_ou_frente   Boolean?
  balanca_corpo_frente_para_tras      Boolean?
  pula_ou_gira_em_torno_de_si         Boolean?
  repete_sons_sem_funcao_comunicativa Boolean?
  repete_movimentos_continuos         Boolean?
  explora_ambiente_lambendo_tocando   Boolean?
  procura_observar_objetos_canto_olho Boolean?
  organiza_objetos_lado_a_lado        Boolean?
  realiza_tarefas_sempre_mesma_ordem  Boolean?
  apresenta_rituais_diarios           Boolean?

  estereotipias_rituais_observacoes_topografias String?

  // PROBLEMAS DE COMPORTAMENTO
  apresenta_comportamentos_auto_lesivos Boolean?
  auto_lesivos_quais                    String?

  apresenta_comportamentos_heteroagressivos Boolean?
  heteroagressivos_quais                    String?

  apresenta_destruicao_propriedade Boolean?
  destruicao_descrever             String?

  necessitou_contencao_mecanica Boolean?

  problemas_comportamento_observacoes_topografias String?

  @@index([anamnese_id])
}

model anamnese_finalizacao {
  anamnese_id Int      @id
  anamnese    anamnese @relation("anamnese_finalizacao", fields: [anamnese_id], references: [id], onDelete: Cascade)

  outras_informacoes_relevantes    String?
  observacoes_impressoes_terapeuta String?
  expectativas_familia             String?

  @@index([anamnese_id])
}

model formacao {
  id                      Int             @id @default(autoincrement())
  graduacao               String?
  instituicao_graduacao   String?
  ano_formatura           Int?
  participacao_congressos String?         @db.Text
  publicacoes_descricao   String?         @db.Text
  terapeuta_id            String          @unique
  terapeuta               terapeuta       @relation(fields: [terapeuta_id], references: [id])
  pos_graduacao           pos_graduacao[]

  @@index([terapeuta_id], map: "formacao_terapeuta_id_fkey")
}

model pos_graduacao {
  id          Int      @id @default(autoincrement())
  tipo        String?
  curso       String?
  instituicao String?
  conclusao   String?
  formacao_id Int
  formacao    formacao @relation(fields: [formacao_id], references: [id])

  @@index([formacao_id], map: "pos_graduacao_formacao_id_fkey")
}

model registro_profissional {
  id              Int          @id @default(autoincrement())
  numero_conselho String?
  terapeuta_id    String
  area_atuacao_id Int
  cargo_id        Int?
  area_atuacao    area_atuacao @relation(fields: [area_atuacao_id], references: [id])
  cargo           cargo?       @relation(fields: [cargo_id], references: [id])
  terapeuta       terapeuta    @relation(fields: [terapeuta_id], references: [id])

  @@index([area_atuacao_id])
  @@index([cargo_id])
  @@index([terapeuta_id], map: "registro_profissional_terapeuta_id_fkey")
}

model pessoa_juridica {
  id           Int       @id @default(autoincrement())
  cnpj         String?   @unique
  razao_social String?
  endereco_id  Int
  terapeuta_id String    @unique
  endereco     endereco  @relation(fields: [endereco_id], references: [id])
  terapeuta    terapeuta @relation(fields: [terapeuta_id], references: [id])

  @@index([endereco_id], map: "pessoa_juridica_endereco_id_fkey")
}

model disciplina {
  id        Int         @id @default(autoincrement())
  nome      String      @unique
  terapeuta terapeuta[] @relation("disciplinaToterapeuta")
}

model sessao_trial {
  id               Int    @id @default(autoincrement())
  sessao_id        Int
  estimulos_ocp_id Int
  ordem            Int
  resultado        String
  duracao_minutos  Int?

  // Fisioterapia
  utilizou_carga        Boolean?
  valor_carga           Float?
  teve_desconforto      Boolean?
  descricao_desconforto String?
  teve_compensacao      Boolean?
  descricao_compensacao String?

  // Musicoterapia
  participacao Int?
  suporte      Int?

  estimulosOcp estimulo_ocp @relation(fields: [estimulos_ocp_id], references: [id], onDelete: Cascade)
  sessao       sessao       @relation(fields: [sessao_id], references: [id], onDelete: Cascade)

  @@index([sessao_id])
  @@index([estimulos_ocp_id])
}

model sessao {
  id                 Int              @id @default(autoincrement())
  ocp_id             Int
  cliente_id         String
  terapeuta_id       String
  data_criacao       DateTime         @default(now())
  criado_em          DateTime         @default(now())
  atualizado_em      DateTime         @updatedAt
  observacoes_sessao String?          @db.Text
  area               String
  cliente            cliente          @relation(fields: [cliente_id], references: [id])
  ocp                ocp              @relation(fields: [ocp_id], references: [id], onDelete: Cascade)
  terapeuta          terapeuta        @relation(fields: [terapeuta_id], references: [id])
  trials             sessao_trial[]
  arquivos           sessao_arquivo[]

  @@index([terapeuta_id, data_criacao])
  @@index([ocp_id])
  @@index([area])
  @@index([ocp_id, area])
  @@index([cliente_id], map: "sessao_cliente_id_fkey")
}

model estimulo {
  id        Int            @id @default(autoincrement())
  nome      String         @unique
  descricao String?        @db.Text
  ocps      estimulo_ocp[]
}

model estimulo_ocp {
  id                     Int            @id @default(autoincrement())
  id_estimulo            Int
  id_ocp                 Int
  nome                   String?
  descricao              String?        @db.Text
  metodos                String?        @db.Text
  tecnicas_procedimentos String?        @db.Text
  status                 Boolean
  estimulo               estimulo       @relation(fields: [id_estimulo], references: [id], onDelete: Cascade)
  ocp                    ocp            @relation(fields: [id_ocp], references: [id], onDelete: Cascade)
  trials                 sessao_trial[]

  @@unique([id_estimulo, id_ocp])
  @@index([id_ocp], map: "estimulo_ocp_id_ocp_fkey")
}

model ocp {
  id                    Int            @id @default(autoincrement())
  cliente_id            String
  terapeuta_id          String
  nome_programa         String
  data_inicio           DateTime
  data_fim              DateTime
  objetivo_programa     String?
  objetivo_descricao    String?        @db.Text
  criterio_aprendizagem String?        @db.Text
  objetivo_curto        String?        @db.Text
  descricao_aplicacao   String?        @db.Text
  observacao_geral      String?        @db.Text
  criado_em             DateTime       @default(now())
  atualizado_em         DateTime       @updatedAt
  status                String         @default("ativado")
  area                  String
  desempenho_atual      String?        @db.Text
  estimulo_ocp          estimulo_ocp[]
  cliente               cliente        @relation(fields: [cliente_id], references: [id])
  terapeuta             terapeuta      @relation("TerapeutaOcp", fields: [terapeuta_id], references: [id])
  sessoes               sessao[]

  @@index([cliente_id])
  @@index([area])
  @@index([cliente_id, area])
  @@index([nome_programa])
  @@index([terapeuta_id], map: "ocp_terapeuta_id_fkey")
}

model terapeuta_cliente {
  id            Int       @id @default(autoincrement())
  terapeuta_id  String
  cliente_id    String
  atualizado_em DateTime  @updatedAt
  criado_em     DateTime  @default(now())
  data_fim      DateTime?
  data_inicio   DateTime
  observacoes   String?   @db.Text
  papel         String    @default("responsible")
  status        String    @default("active")
  area_atuacao  String?
  cliente       cliente   @relation(fields: [cliente_id], references: [id], onDelete: Cascade)
  terapeuta     terapeuta @relation(fields: [terapeuta_id], references: [id], onDelete: Cascade)

  @@index([terapeuta_id])
  @@index([cliente_id])
}

model vinculo_supervisao {
  id                Int       @id @default(autoincrement())
  supervisor_id     String
  clinico_id        String
  nivel_hierarquia  Int?      @default(1)
  escopo_supervisao String?   @default("direto")
  data_inicio       DateTime
  data_fim          DateTime?
  status            String    @default("ativo")
  observacoes       String?
  criado_em         DateTime  @default(now())
  atualizado_em     DateTime  @updatedAt
  clinico           terapeuta @relation("ClinicoVinculo", fields: [clinico_id], references: [id], onDelete: Cascade)
  supervisor        terapeuta @relation("SupervisorVinculo", fields: [supervisor_id], references: [id], onDelete: Cascade)

  @@unique([supervisor_id, clinico_id])
  @@index([supervisor_id])
  @@index([clinico_id])
}

model sessao_arquivo {
  id            Int      @id @default(autoincrement())
  sessao_id     Int
  nome          String
  caminho       String
  tamanho       Int
  criado_em     DateTime @default(now())
  atualizado_em DateTime @updatedAt

  sessao sessao @relation(fields: [sessao_id], references: [id], onDelete: Cascade)

  @@index([sessao_id])
}

model ocp_prontuario {
  id Int @id @default(autoincrement())

  cliente_id String
  clientes cliente @relation(fields: [cliente_id], references: [id], onDelete: Cascade)

  terapeuta_id String
  terapeutas terapeuta @relation(fields: [terapeuta_id], references: [id], onDelete: Cascade)

  profissao_ocupacao String?
  observacao_educacional String? @db.Text

  observacoes_nucleo_familiar String? @db.Text
  
  encaminhado_por String?
  motivo_busca_atendimento String
  atendimentos_anteriores String?
  observacao_demanda String? @db.Text

  objetivos_trabalho String
  avaliacao_atendimento String?

  @@index([cliente_id])
  @@index([terapeuta_id])
}

model ata_reuniao {
  id Int @id @default(autoincrement())

  terapeuta_id String
  terapeuta    terapeuta @relation(fields: [terapeuta_id], references: [id], onDelete: Restrict)
  cliente_id   String?
  cliente      cliente?  @relation(fields: [cliente_id], references: [id], onDelete: SetNull)

  data           DateTime @db.Date
  horario_inicio String
  horario_fim    String

  finalidade        ata_finalidade_reuniao
  finalidade_outros String?

  modalidade ata_modalidade_reuniao
  conteudo   String                 @db.Text
  status     ata_status             @default(rascunho)

  // cabeçalho salva as informações para casos de auditoria
  cabecalho_terapeuta_id    String
  cabecalho_terapeuta_nome  String
  cabecalho_conselho_numero String?
  cabecalho_area_atuacao    String?
  cabecalho_cargo           String?

  duracao_minutos Int?
  horas_faturadas Decimal? @db.Decimal(10, 2)

  resumo_ia String? @db.Text

  criado_em     DateTime @default(now())
  atualizado_em DateTime @updatedAt

  participantes ata_participante[]
  links         ata_link_recomendacao[]
  anexos        ata_anexo[]

  @@index([terapeuta_id])
  @@index([cliente_id])
  @@index([data])
}

model ata_participante {
  id Int @id @default(autoincrement())

  ata_reuniao_id Int
  ata_reuniao    ata_reuniao @relation(fields: [ata_reuniao_id], references: [id], onDelete: Cascade)

  tipo         ata_participante_tipo
  nome         String
  descricao    String?
  terapeuta_id String?
  terapeuta    terapeuta?            @relation(fields: [terapeuta_id], references: [id], onDelete: SetNull)

  criado_em DateTime @default(now())

  @@index([ata_reuniao_id])
  @@index([terapeuta_id])
}

model ata_link_recomendacao {
  id Int @id @default(autoincrement())

  ata_reuniao_id Int
  ata_reuniao    ata_reuniao @relation(fields: [ata_reuniao_id], references: [id], onDelete: Cascade)

  titulo String
  url    String @db.Text

  criado_em DateTime @default(now())

  @@index([ata_reuniao_id])
}

model ata_anexo {
  id Int @id @default(autoincrement())

  ata_reuniao_id Int
  ata_reuniao    ata_reuniao @relation(fields: [ata_reuniao_id], references: [id], onDelete: Cascade)

  external_id String
  nome        String?

  original_nome String?
  mime_type     String?
  tamanho       Int?

  caminho String @db.Text

  criado_em DateTime @default(now())

  @@unique([ata_reuniao_id, external_id])
  @@index([ata_reuniao_id])
}
